 **Входы:**

1.Конфиг эл нагревателя (0-нет, 1-ступенчатое, 2-твёрдотелка, 3-особый)  «Конфиг» работы системы (Получаем из конфигурации).
2. Код состояния системы(Код) (получем из конечных автоматов).
3. Период ТЭНов- мин. интервал между вкл. и выкл.(получаем из конфигурации).
4. Обратная связь с контактором KM (DI).

**Выходы:**

1.       Производительность эл нагревателя % (в журнал). 
2.       Выход «Продувка завершена» (идет на конечный автомат).
3.       «Перегрев эл. нагревателя» (идет на конечный автомат).
4.       «КМ безопасности»  (идет на шифратор DO выходы).
5.       Ступени – (идет на шифратор DO выходы).

**Алгоритм работы:**

1.       Если калорифер подал сигнал о работе или термостат разомкнулся, то требуется продувка(!ПродувкаОК),  иначе   продувка требуется(ПродувкаОК).

2.       Для защиты от частого переключения ступеней, при смене ступени  отключаем смену напряжения на выходе на период равный периоду ТЭНА.

3.       «Обратная связь КМ» отвечает за аварию при перегреве(130 градусов). Передается в конечный автомат и журнал аварий.

4.       Определяем уставку каждой ступени в зависимости от входной переменной “Количество ступеней”.  Сравниваем уставку с итоговым напряжением на выходе из D триггера. Передаем сведение о включенных ступенях на выход из макроса.